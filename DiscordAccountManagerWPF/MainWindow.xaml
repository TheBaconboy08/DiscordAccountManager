<Window x:Class="DiscordAccountManagerWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Discord Account Manager"
        Height="483" Width="835"
        Background="Transparent"
        AllowsTransparency="True"
        WindowStyle="None"
        ResizeMode="CanResizeWithGrip">

    <!-- ✅ RESOURCES MUST BE DEFINED FIRST -->
    <Window.Resources>
        <Style x:Key="CopyButton" TargetType="Button">
            <Setter Property="Width" Value="90"/>
            <Setter Property="Height" Value="28"/>
            <Setter Property="Background" Value="#4F545C"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border CornerRadius="6" 
                                Background="{TemplateBinding Background}"
                                Padding="8,2">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#5865F2"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- ListBox Style to remove default selection highlighting -->
        <Style x:Key="AccountListBoxStyle" TargetType="ListBox">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="SelectionMode" Value="Single"/>
        </Style>

        <!-- ListBoxItem Style to maintain your custom styling -->
        <Style x:Key="AccountListBoxItemStyle" TargetType="ListBoxItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Border x:Name="ItemBorder"
                                CornerRadius="12"
                                Background="#313338"
                                Padding="15"
                                Margin="0,0,0,12"
                                Cursor="Hand">
                            <Border.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Copy Email" Click="CopySelectedEmail_Click"/>
                                    <MenuItem Header="Copy Password" Click="CopySelectedPassword_Click"/>
                                    <MenuItem Header="Copy UserId" Click="CopySelectedUserId_Click"/>
                                    <MenuItem Header="Copy Token" Click="CopyTokenFromContextMenu_Click"/>
                                    <Separator/>
                                    <MenuItem Header="Remove Account" Click="RemoveAccountFromContextMenu_Click"/>
                                </ContextMenu>
                            </Border.ContextMenu>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Account Info -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="{Binding Email}" 
                                               Foreground="White" 
                                               FontSize="14" 
                                               FontWeight="SemiBold"/>
                                    <!--<TextBlock Text="Password: ******" 
                                               Foreground="#B5BAC1" 
                                               FontSize="12"
                                               Margin="0,4,0,0"/>-->
                                </StackPanel>

                                <!-- Copy Buttons -->
                                <StackPanel Grid.Column="1" 
                                            Orientation="Horizontal" 
                                            VerticalAlignment="Center">
                                    <Button Content="Copy Email" 
                                            Click="CopyEmail_Click"
                                            Tag="{Binding}"
                                            Style="{StaticResource CopyButton}"/>
                                    <Button Content="Copy Pass" 
                                            Click="CopyPassword_Click"
                                            Tag="{Binding}"
                                            Style="{StaticResource CopyButton}"
                                            Margin="6,0,0,0"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="ItemBorder" Property="Background" Value="#3E4045"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="ItemBorder" Property="Background" Value="#383A3F"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- 🟢 ROOT ROUNDED CONTAINER -->
    <Border CornerRadius="16"
            Background="#2B2D31"
            Padding="1">
        <Grid>
            <!-- 🔹 ROUNDED TITLE BAR -->
            <Border Height="40" 
                    VerticalAlignment="Top" 
                    Background="#232428"
                    CornerRadius="16,16,0,0"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid>
                    <TextBlock Text="Discord Account Manager"
                               Foreground="White"
                               VerticalAlignment="Center"
                               Margin="20,0,0,0"
                               FontSize="14" FontWeight="SemiBold"/>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,10,0">
                        <Button Content="─" Width="30" Height="30" Background="Transparent" Foreground="White" BorderThickness="0" Click="MinimizeButton_Click"/>
                        <Button Content="✕" Width="30" Height="30" Background="Transparent" Foreground="White" BorderThickness="0" Click="CloseButton_Click"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- 🔹 MAIN CONTENT GRID (VISIBLE BY DEFAULT) -->
            <Grid x:Name="MainGrid" Margin="0,40,0,60" Visibility="Visible">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        <TextBlock Text="Accounts" 
                                   Foreground="#7289DA" 
                                   FontSize="20" 
                                   FontWeight="Bold" 
                                   Margin="0,0,0,15"/>

                        <ListBox x:Name="AccountList"
                                 Style="{StaticResource AccountListBoxStyle}"
                                 ItemContainerStyle="{StaticResource AccountListBoxItemStyle}"/>
                    </StackPanel>
                </ScrollViewer>
            </Grid>

            <!-- 🔹 OPTIONS GRID (HIDDEN BY DEFAULT) -->
            <Grid x:Name="OptionsGrid" Margin="0,40,0,60" Visibility="Hidden">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        <TextBlock Text="Options"
                       Foreground="#7289DA" 
                       FontSize="20" 
                       FontWeight="Bold" 
                       Margin="0,0,0,20"/>

                        

                        <Separator Background="#4F545C" Height="1" Margin="0,10"/>

                        <!-- Behavior Settings -->
                        <!--<TextBlock Text="Behavior" Foreground="White" FontSize="16" Margin="0,16,0,10"/>
                        <CheckBox Content="Start minimized to tray"
                      Foreground="White"
                      Margin="0,8,0,0"/>
                        <CheckBox Content="Confirm before removing account"
                      Foreground="White"
                      Margin="0,8,0,0"/>-->

                        <!--<Separator Background="#4F545C" Height="1" Margin="0,16"/>-->
                        <TextBlock Text="UI" Foreground="White" FontSize="16" Margin="0,16,0,10"/>
                        <CheckBox x:Name="TopMostCheckBox"
          Content="TopMost"
          Foreground="White"
          Margin="0,8,0,0"
          Checked="TopMostCheckBox_CheckedChanged"
          Unchecked="TopMostCheckBox_CheckedChanged"/>


                        <Separator Background="#4F545C" Height="1" Margin="0,16"/>

                        <!-- Appearance --><!--
                        <TextBlock Text="Appearance" Foreground="White" FontSize="16" Margin="0,16,0,10"/>-->


                        <TextBlock Text="Note: Some settings require restart." 
                       Foreground="#B5BAC1" 
                       FontSize="12" 
                       FontStyle="Italic"
                       Margin="0,20,0,0"/>
                    </StackPanel>
                </ScrollViewer>
            </Grid>

            <!-- 🔘 BOTTOM ACTION BUTTONS -->
            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Bottom"
                        Margin="20,0,0,15">

                <!-- Add Account -->
                <Button HorizontalAlignment="Left"
        Margin="0,0,10,0"
        Padding="14,8"
        Background="#5865F2"
        Foreground="White"
        BorderThickness="0"
        Cursor="Hand"
        Click="AddAccount_Click">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="MainBorder"
                    CornerRadius="8"
                    Background="{TemplateBinding Background}"
                    Padding="{TemplateBinding Padding}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Main Content (Icon + Text) -->
                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                        <TextBlock Text="{}&#xE710;" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,6,0"/>
                                        <TextBlock Text="Add Account" VerticalAlignment="Center"/>
                                    </StackPanel>

                                    <!-- Embedded Dropdown Button (Always Visible) -->
                                    <Button x:Name="DropdownButton"
                            Grid.Column="1"
                            Width="20"
                            Height="20"
                            Margin="6,0,0,0"
                            Background="#4A55C2"
                            Foreground="#FFFFFFCC"
                            FontSize="10"
                            Padding="0"
                            BorderThickness="0"
                            Cursor="Hand"
                            Click="DropdownButton_Click">
                                        <Button.Template>
                                            <ControlTemplate TargetType="Button">
                                                <Border CornerRadius="4"
                                        Background="{TemplateBinding Background}"
                                        Padding="{TemplateBinding Padding}">
                                                    <TextBlock Text="▼" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#3D47A3"/>
                                                        <Setter Property="Foreground" Value="White"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="MainBorder" Property="Background" Value="#4752C4"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>

                <!-- Remove Selected Account -->
                <Button HorizontalAlignment="Left"
                        Margin="0,0,10,0"
                        Padding="14,8"
                        Background="#ED4245"
                        Foreground="White"
                        BorderThickness="0"
                        Cursor="Hand"
                        Click="RemoveSelectedAccount_Click">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border CornerRadius="8" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <TextBlock Text="{}&#xE74D;" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,6,0"/>
                                    <ContentPresenter/>
                                </StackPanel>
                            </Border>
                        </ControlTemplate>
                    </Button.Template>
                    <TextBlock Text="Remove Selected" VerticalAlignment="Center"/>
                </Button>

                <!-- Open Selected in Browser -->
                <Button HorizontalAlignment="Left"
                        Margin="0,0,10,0"
                        Padding="14,8"
                        Background="#3BA55C"
                        Foreground="White"
                        BorderThickness="0"
                        Cursor="Hand"
                        Click="OpenSelectedAccountInBrowser_Click">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border CornerRadius="8" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <TextBlock Text="{}&#xE774;" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,6,0"/>
                                    <ContentPresenter/>
                                </StackPanel>
                            </Border>
                        </ControlTemplate>
                    </Button.Template>
                    <TextBlock Text="Open Selected" VerticalAlignment="Center"/>
                </Button>

                <!-- 🔁 OPTIONS TOGGLE BUTTON -->
                <Button HorizontalAlignment="Left"
                        Padding="14,8"
                        Background="#4F545C"
                        Foreground="White"
                        BorderThickness="0"
                        Cursor="Hand"
                        Click="ToggleOptions_Click">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border CornerRadius="8" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <TextBlock Text="{}&#xE713;" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,6,0"/>
                                    <ContentPresenter/>
                                </StackPanel>
                            </Border>
                        </ControlTemplate>
                    </Button.Template>
                    <TextBlock Text="Options" VerticalAlignment="Center"/>
                </Button>
            </StackPanel>
        </Grid>
    </Border>
</Window>